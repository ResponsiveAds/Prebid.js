<html>

<head>
    <script async src="../../build/dev/prebid.js"></script>
    <script async src="https://securepubads.g.doubleclick.net/tag/js/gpt.js"></script>

    <script src="./customResizeFn.js"></script>
    <script>
        var FAILSAFE_TIMEOUT = 3300;
        var PREBID_TIMEOUT = 1000;
        
        var adUnits = [{
            code: 'div-gpt-ad-1460505748561-0',
            mediaTypes: {
                banner: {
                    sizes: [[300, 250]],
                }
            },
            
            // Custom resize function for this adUnit
            customResizeFn: customResizeFn,
            
            // Replace this object to test a new Adapter!
            bids: [{
                bidder: 'adnuntius',
                params: {
                    auId: "201208",
                    network: "1287",
                    bidType: 'netBid'
                }
            }]
        }];
        
        var pbjs = pbjs || {};
        pbjs.que = pbjs.que || [];
        
    </script>
    
    <script>
        var googletag = googletag || {};
        googletag.cmd = googletag.cmd || [];
        googletag.cmd.push(function () {
            googletag.pubads().disableInitialLoad();
        });
        
        pbjs.que.push(function () {
            pbjs.addAdUnits(adUnits);
            
            pbjs.requestBids({
                bidsBackHandler: sendAdserverRequest,
                timeout: PREBID_TIMEOUT
            });
        });
        
        function sendAdserverRequest() {
            if (pbjs.adserverRequestSent) return;
            pbjs.adserverRequestSent = true;
            googletag.cmd.push(function () {
                if (pbjs.libLoaded) {
                    pbjs.que.push(function () {
                        pbjs.setTargetingForGPTAsync();
                        googletag.pubads().refresh();
                    });
                } else {
                    googletag.pubads().refresh();
                }
            });
        }
        
        setTimeout(function () {
            sendAdserverRequest();
        }, FAILSAFE_TIMEOUT);
        
    </script>
    
    <script>
        googletag.cmd.push(function () {
            googletag.defineSlot('/19968336/header-bid-tag-0', [[300, 250], [300, 600]], 'div-gpt-ad-1460505748561-0').addService(googletag.pubads());
            
            googletag.pubads().enableSingleRequest();
            googletag.enableServices();
        });
    </script>
</head>

<body>
    <h2>Prebid.js Test - Custom ResizeFn Demo</h2>
    <p>This example demonstrates a custom resize function that adds styling and logging when ads are resized.</p>
    <h5>Div-1 (with custom resizeFn)</h5>
    <div id='div-gpt-ad-1460505748561-0'>
        <script type='text/javascript'>
            googletag.cmd.push(function () { googletag.display('div-gpt-ad-1460505748561-0'); });
        </script>
    </div>
</body>

</html>
